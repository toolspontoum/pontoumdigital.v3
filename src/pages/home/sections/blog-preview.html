<section id="latest-blog" class="py-24 bg-zinc-50 border-t border-zinc-200">
    <div class="max-w-grid mx-auto px-6">
        <div class="flex flex-col md:flex-row items-end justify-between mb-12 gap-6">
            <div class="max-w-xl">
                <span class="text-[10px] uppercase tracking-[0.3em] text-red-600 font-bold mb-4 block">Knowledge
                    Hub</span>
                <h2 class="text-3xl md:text-5xl font-bold text-slate-900 tracking-tight">Últimos do <span
                        class="bg-red-600/10 px-2 text-red-600">Blog</span></h2>
            </div>
            <a href="/blog/"
                class="text-xs font-bold uppercase tracking-widest text-slate-400 hover:text-red-600 transition-colors group flex items-center gap-3">
                Ver todos os artigos
                <span class="w-8 h-[1px] bg-slate-300 group-hover:bg-red-600 group-hover:w-12 transition-all"></span>
            </a>
        </div>

        <div id="home-blog-grid" class="grid grid-cols-1 md:grid-cols-3 gap-8">
            <!-- Injetado via JS -->
            <div class="col-span-full py-20 text-center text-slate-400">Carregando insights...</div>
        </div>
    </div>
</section>

<script type="module">
    import { BlogStore } from '/src/js/blog/blog-store.js';

    async function initHomeBlog() {
        const posts = await BlogStore.fetchIndex();
        const grid = document.getElementById('home-blog-grid');

        if (!grid) return;

        if (posts.length === 0) {
            grid.innerHTML = '<div class="col-span-full py-10 text-center text-slate-400">Em breve, novos conteúdos técnicos por aqui.</div>';
            return;
        }

        const latest = posts.slice(0, 3);
        grid.innerHTML = latest.map(post => {
            // Reaproveita a estrutura do post-card mas ajusta cores para fundo claro da home
            return `
            <article class="group bg-white border border-slate-200 rounded-2xl overflow-hidden hover:border-red-600/30 transition-all duration-500 flex flex-col h-full shadow-sm hover:shadow-xl">
                <a href="/blog/post.html?slug=${post.slug}" class="block aspect-video overflow-hidden">
                    <img src="${post.featured_image.url}" alt="${post.featured_image.alt_text}" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-700">
                </a>
                <div class="p-6 flex flex-col flex-grow">
                    <div class="flex items-center gap-3 mb-4">
                        <span class="text-[10px] uppercase tracking-[0.2em] text-red-600 font-bold bg-red-600/5 px-2 py-1 rounded">
                            ${post.category.name}
                        </span>
                        <span class="text-[10px] uppercase tracking-[0.1em] text-slate-400">
                            ${BlogStore.formatDate(post.publication_date)}
                        </span>
                    </div>
                    <h3 class="text-xl font-bold text-slate-900 mb-3 group-hover:text-red-600 transition-colors leading-tight">
                        ${post.title}
                    </h3>
                    <p class="text-slate-500 text-sm line-clamp-2 mb-6 flex-grow leading-relaxed">
                        ${post.description}
                    </p>
                    <a href="/blog/post.html?slug=${post.slug}" class="text-xs uppercase tracking-[0.2em] text-slate-900 font-bold flex items-center gap-2 group/link">
                        Explorar
                        <span class="w-8 h-[1px] bg-red-600 group-hover/link:w-12 transition-all duration-300"></span>
                    </a>
                </div>
            </article>
            `;
        }).join('');
    }

    // Inicializa quando o DOM estiver pronto
    document.addEventListener('DOMContentLoaded', initHomeBlog);
    // Fallback caso o DOMContentLoaded já tenha disparado
    if (document.readyState === 'interactive' || document.readyState === 'complete') {
        initHomeBlog();
    }
</script>